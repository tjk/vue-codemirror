/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/
import{inject as e,defineComponent as t,shallowRef as n,computed as o,toRaw as r,onMounted as a,watch as i,onBeforeUnmount as u,h as c}from"vue";import{basicSetup as s}from"codemirror";import{EditorState as l,Compartment as f,StateEffect as d}from"@codemirror/state";import{EditorView as m,keymap as p,placeholder as v}from"@codemirror/view";import{indentWithTab as g}from"@codemirror/commands";import{indentUnit as b}from"@codemirror/language";var h=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[s]}),y=Symbol("vue-codemirror-global-config");var O,j=function(e){var t=e.onUpdate,n=e.onChange,o=e.onFocus,r=e.onBlur,a=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}(e,["onUpdate","onChange","onFocus","onBlur"]);return l.create({doc:a.doc,selection:a.selection,extensions:(Array.isArray(a.extensions)?a.extensions:[a.extensions]).concat([m.updateListener.of((function(e){t(e),e.docChanged&&n(e.state.doc.toString(),e),e.focusChanged&&(e.view.hasFocus?o(e):r(e))}))])})},x=function(e){var t=new f;return{compartment:t,run:function(n){t.get(e.state)?e.dispatch({effects:t.reconfigure(n)}):e.dispatch({effects:d.appendConfig.of(t.of(n))})}}},S=function(e,t){var n=x(e),o=n.compartment,r=n.run;return function(n){var a=o.get(e.state);r((null!=n?n:a!==t)?t:[])}},C={type:Boolean,default:void 0},w={autofocus:C,disabled:C,indentWithTab:C,tabSize:Number,placeholder:String,style:Object,autoDestroy:C,phrases:Object,rawExtensions:C,root:Object,extensions:Array,selection:Object},D={modelValue:{type:String,default:""}},U=Object.assign(Object.assign({},w),D);!function(e){e.Change="change",e.Update="update",e.Focus="focus",e.Blur="blur",e.Ready="ready",e.ModelUpdate="update:modelValue"}(O||(O={}));var z={};z[O.Change]=function(e,t){return!0},z[O.Update]=function(e){return!0},z[O.Focus]=function(e){return!0},z[O.Blur]=function(e){return!0},z[O.Ready]=function(e){return!0};var B={};B[O.ModelUpdate]=z[O.Change];var F=Object.assign(Object.assign({},z),B),P=t({name:"VueCodemirror",props:Object.assign({},U),emits:Object.assign({},F),setup:function(t,s){var f=n(),d=n(),C=n(),w=Object.assign(Object.assign({},h),e(y,{})),D=o((function(){var e={};return Object.keys(r(t)).forEach((function(n){var o;"modelValue"!==n&&(e[n]=null!==(o=t[n])&&void 0!==o?o:w[n])})),e}));return a((function(){var e;d.value=j({doc:t.modelValue,selection:D.value.selection,extensions:t.rawExtensions?[]:null!==(e=w.extensions)&&void 0!==e?e:[],onFocus:function(e){return s.emit(O.Focus,e)},onBlur:function(e){return s.emit(O.Blur,e)},onUpdate:function(e){return s.emit(O.Update,e)},onChange:function(e,n){e!==t.modelValue&&(s.emit(O.Change,e,n),s.emit(O.ModelUpdate,e,n))}}),C.value=function(e){return new m(Object.assign({},e))}({state:d.value,parent:f.value,root:D.value.root});var n=function(e){var t=function(){return e.state.doc.toString()},n=x(e).run,o=S(e,[m.editable.of(!1),l.readOnly.of(!0)]),r=S(e,p.of([g])),a=x(e).run,i=x(e).run,u=x(e).run,c=x(e).run;return{focus:function(){return e.focus()},getDoc:t,setDoc:function(n){n!==t()&&e.dispatch({changes:{from:0,to:e.state.doc.length,insert:n}})},reExtensions:n,toggleDisabled:o,toggleIndentWithTab:r,setTabSize:function(e){a([l.tabSize.of(e),b.of(" ".repeat(e))])},setPhrases:function(e){i([l.phrases.of(e)])},setPlaceholder:function(e){u(v(e))},setStyle:function(e){void 0===e&&(e={}),c(m.theme({"&":Object.assign({},e)}))}}}(C.value);i((function(){return t.modelValue}),(function(e){e!==n.getDoc()&&n.setDoc(e)})),i((function(){return t.extensions}),(function(e){return n.reExtensions(e||[])}),{immediate:!0}),i((function(){return D.value.disabled}),(function(e){return n.toggleDisabled(e)}),{immediate:!0}),i((function(){return D.value.indentWithTab}),(function(e){return n.toggleIndentWithTab(e)}),{immediate:!0}),i((function(){return D.value.tabSize}),(function(e){return n.setTabSize(e)}),{immediate:!0}),i((function(){return D.value.phrases}),(function(e){return n.setPhrases(e||{})}),{immediate:!0}),i((function(){return D.value.placeholder}),(function(e){return n.setPlaceholder(e)}),{immediate:!0}),i((function(){return D.value.style}),(function(e){return n.setStyle(e)}),{immediate:!0}),D.value.autofocus&&n.focus(),s.emit(O.Ready,{state:d.value,view:C.value,container:f.value})})),u((function(){D.value.autoDestroy&&C.value&&function(e){e.destroy()}(C.value)})),function(){return c("div",{class:"v-codemirror",style:{display:"contents"},ref:f})}}}),T=P,V=function(e,t){e.component(P.name,P),e.component("Codemirror",P),function(e,t){e.provide(y,t)}(e,t)},E={Codemirror:T,install:V};export{T as Codemirror,h as DEFAULT_CONFIG,E as default,V as install};
//# sourceMappingURL=vue-codemirror.esm.js.map
